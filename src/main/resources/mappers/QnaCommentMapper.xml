<?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

    <mapper namespace="bucheon.leafy.application.mapper.QnaCommentMapper">

        <delete id="deleteAll">
            DELETE FROM qna_comment
        </delete>

        <delete id="delete" parameterType="map">
            DELETE FROM qna_comment WHERE id = #{id} and user_user_id = #{user_user_id}
        </delete>

        <insert id="insert" parameterType="QnaCommentDto">
            INSERT INTO qna_comment
                (title, contents, id, qan_status)
            VALUES
                (#{title}, #{contents}, #{id}, #{qan_status})
        </insert>

        <select id="selectAll" resultType="QnaCommentDto">
            SELECT id, created_at, modified_at, is_delete ,comment, user_user_id
            FROM qna_comment
            ORDER BY created_at DESC, id DESC
        </select>

        <sql id="selectFrom">
            SELECT id, created_at, modified_at, is_delete ,comment, user_user_id
            FROM qna_comment
        </sql>

        <select id="select" parameterType="int" resultType="QnaCommentDto">
            <include refid="selectFrom"/>
            WHERE id = #{id}
        </select>

        <update id="update" parameterType="QnaCommentDto">
            UPDATE qna_comment
            SET   title = #{title}
              , contents = #{contents}
              , modified_at = now()
            WHERE user_user_id = #{user_user_id}
        </update>

    </mapper>
